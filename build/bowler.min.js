/*
 * Bowler.js - 0.0.6 
 * Description : a simple MV framework using handlebars & jQuery 
 * Project Url : https://github.com/jacoblwe20/bowler.git 
 * Author : Jacob Lowe <jacoblowe.me> 
 * License : MIT 
 */

!function(a){var b=function(a,c){return this instanceof b?("function"==typeof c&&c(this),a.prototype=this,a):new b(a)};b.prototype=b.plus={},b.prototype.getState=function(){return this.__state},b.prototype.setState=function(a){this.__state=+a},a.Marrow=b}(this);var Marrow=Marrow?Marrow:exports.Marrow;!function(a){a.prototype.__events=function(){this._events={}},a.prototype.on=function(a,b){return"function"==typeof b&&"string"==typeof a&&(this._events||this.__events(),"object"!=typeof this._events[a]&&(this._events[a]=[]),"number"==typeof this._events[a].length&&this._events[a].push(b)),this},a.prototype.off=function(a,b){if("object"==typeof this._events&&"string"==typeof a&&"object"==typeof this._events[a]&&this._events[a].length){var c=this._events[a];if("function"==typeof b)for(var d=0;d<c.length;d+=1)c[d]===b&&delete c[d];else c=[]}else a||(this._events={})},a.prototype.emit=function(a){if("object"==typeof this._events&&"string"==typeof a&&"object"==typeof this._events[a]&&this._events[a].length)for(var b=[].slice.call(arguments),c=0;c<this._events[a].length;c+=1)this._events[a][c].apply(this,b.slice(1))}}(Marrow),function(a){a.prototype.__extend=function(a,b,c){var d=this;this[a]=function(){"function"==typeof this[c]&&d[c].apply(this,arguments),"number"==typeof b&&(d.__state=b),d.emit(a)}},a.prototype.to=function(a,b,c){if("string"==typeof a&&"function"==typeof b){var d="__"+a;this[d]=b,this.__extend(a,c,d)}}}(Marrow),function(a,b,c){var d=function(){return this instanceof d?(this._models={},this._views={},c.extend(this,this.View("bowler")),c.extend(this,this.Model("bowler")),this.Helper(),this):new d};d=b(d),d.prototype.Helper=function(){var a=this;this.registerHelper("child",function(b){a._children||(a._children={}),a._children[b]="true";var d=c("<span/>").attr("data-bind",b).html(a._views[b]&&"string"==typeof a._views[b].view?a._views[b].view.toString():"");return a._children[b]=!0,new a.SafeString(c("<div/>").append(d).html())})},a.Bowler=d}(this,Marrow,jQuery),function(a,b){var c;c=a.prototype.Model=function(b,d,e){return b?this instanceof c?(this.context=e,e.model&&"undefined"==typeof e.model._children&&(e.model._children={}),this.model={},d&&this.extend(d),e._models[b]=this,this):(this instanceof a&&(e=this),new c(b,d,e)):b},c.prototype.extend=function(a){return"object"==typeof a?(b.extend(this.model,a),this.update(),this.model):null},c.prototype.get=function(a,c){if(a&&"string"==typeof a){var d=this;b.ajax({url:a,dataType:"json",type:"get",error:function(a){c({error:"cannot retrieve data or was not in json format",originalError:a},null)},success:function(a){d.extend(a),c(null,a)}})}else c({error:"path not specified"},null)},c.prototype.update=function(){console.log(this),this.context._views[name]&&that.context._views[name].render()}}(Bowler,jQuery),function(a,b){var c;c=a.prototype.View=function(d,e,f){return d?this instanceof c?(this.context=f,$.extend(this,b),e&&this.render(),f._views[d]=this,this.template=e,this.name=d,this):(this instanceof a&&(f=this),new c(d,e,f)):d},c.prototype.render=function(a){var b=this.context,c=b.model,d=this.name,e=this.view;return"undefined"==typeof a?a=this.template:this.template=a,this.template=this.compile(a),b._models[d]?(e=this.template(b._models[d].model),this.ele&&this.ele.html(e),c._children&&(c._children[d]=e),b._children&&b._children[d]&&!this.ele&&this.bind('[data-bind="'+d+'"]'),e):(this.template=this.compile(template),this.template)},c.prototype.bind=function(a){return this.ele=a instanceof jQuery?a:$(a),this.view&&this.ele.html(this.view),this.ele}}(Bowler,Handlebars);