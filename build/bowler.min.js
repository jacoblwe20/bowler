/*
 * Bowler.js - 0.0.4 
 * Description : a simple MV framework using handlebars & jQuery 
 * Project Url : https://github.com/jacoblwe20/bowler.git 
 * Author : Jacob Lowe <jacoblowe.me> 
 * License :  
 */

!function(a){var b=function(a,c){return this instanceof b?("function"==typeof c&&c(this),a.prototype=this,a):new b(a)};b.prototype=b.plus={},b.prototype.getState=function(){return this.__state},b.prototype.setState=function(a){this.__state=+a},a.Marrow=b}(this);var Marrow=Marrow?Marrow:exports.Marrow;!function(a){a.prototype.__events=function(){this._events={}},a.prototype.on=function(a,b){return"function"==typeof b&&"string"==typeof a&&(this._events||this.__events(),"object"!=typeof this._events[a]&&(this._events[a]=[]),"number"==typeof this._events[a].length&&this._events[a].push(b)),this},a.prototype.off=function(a,b){if("object"==typeof this._events&&"string"==typeof a&&"object"==typeof this._events[a]&&this._events[a].length){var c=this._events[a];if("function"==typeof b)for(var d=0;d<c.length;d+=1)c[d]===b&&delete c[d];else c=[]}else a||(this._events={})},a.prototype.emit=function(a){if("object"==typeof this._events&&"string"==typeof a&&"object"==typeof this._events[a]&&this._events[a].length)for(var b=[].slice.call(arguments),c=0;c<this._events[a].length;c+=1)this._events[a][c].apply(this,b.slice(1))}}(Marrow),function(a){a.prototype.__extend=function(a,b,c){var d=this;this[a]=function(){"function"==typeof this[c]&&d[c].apply(this,arguments),"number"==typeof b&&(d.__state=b),d.emit(a)}},a.prototype.to=function(a,b,c){if("string"==typeof a&&"function"==typeof b){var d="__"+a;this[d]=b,this.__extend(a,c,d)}}}(Marrow),function(a,b,c,d){var e=function(){if(!(this instanceof e))return new e;var a=this;return a._models={},a._views={},a.Model=function(b,d){if(!b)return b;if(!(this instanceof a.Model))return new a.Model(b,d);a.model&&"undefined"==typeof a.model._children&&(a.model._children={});var e=this;return e.model={},e.extend=function(a){return"object"==typeof a?(c.extend(e.model,a),e.update(),e.model):null},e.get=function(a,b){a&&"string"==typeof a?c.ajax({url:a,dataType:"json",type:"get",error:function(a){b({error:"cannot retrieve data or was not in json format",originalError:a},null)},success:function(a){e.extend(a),b(null,a)}}):b({error:"path not specified"},null)},e.update=function(){a._views[b]&&a._views[b].render()},d&&e.extend(d),a._models[b]=e,e},a.View=function(b,e){if(!b)return b;if(!(this instanceof a.View))return new a.View(b,e);var f=this;return f.render=function(c){return"undefined"==typeof c?c=e:e=c,f.template=f.compile(c),a._models[b]?(f.view=f.template(a._models[b].model),f.ele&&f.ele.html(f.view),a.model._children&&(a.model._children[b]=f.view),a._children&&a._children[b]&&!f.ele&&f.bind('[data-bind="'+b+'"]'),f.view):(f.template=f.compile(e),f.template)},f.bind=function(a){return f.ele="object"==typeof a?a:c(a),f.view&&f.ele.html(f.view),f.ele},c.extend(f,d),e&&f.render(),a._views[b]=f,f},c.extend(a,a.Model("bowler")),c.extend(a,a.View("bowler")),d.registerHelper("child",function(b){a._children||(a._children={}),a._children[b]="true";var e=c("<span/>").attr("data-bind",b).html(a._views[b]&&"string"==typeof a._views[b].view?a._views[b].view.toString():"");return a._children[b]=!0,new d.SafeString(c("<div/>").append(e).html())}),a};e=b(e),a.Bowler=e}(this,Marrow,jQuery,Handlebars);